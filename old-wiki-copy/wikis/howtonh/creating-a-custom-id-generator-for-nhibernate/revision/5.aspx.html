

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"> 
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
    <head><meta http-equiv="X-UA-Compatible" content="IE=7" /><meta name="robots" content="index,follow" />
<meta name="description" content="The official NHibernate community site. Download NHibernate. Read blogs. Contribute to the NHibernate Wiki. Find reference documentation." />
<meta name="keywords" content="NHibernate, NHibernate Contrib, community, Burrow, Downloads" />
<meta name="GENERATOR" content="CommunityServer 2008.5 SP1 (Build: 31106.3070)" />
<link rel="shortcut icon" type="image/ico" href="../../../../favicon.ico" />
<link rel="alternate" type="application/rss+xml" title="Creating a custom id generator for nHibernate (RSS 2.0)" href="../rss.aspx"  />
<link rel="alternate" type="application/rss+xml" title="How to (RSS 2.0)" href="http://nhforge.org/wikis/howtonh/rss.aspx"  />
<link rel="alternate" type="application/rss+xml" title="Chris Nicola&#39;s Announcements (RSS 2.0)" href="../../../../members/chnicola/announcements/rss.aspx"  />
<link rel="alternate" type="application/rss+xml" title="Chris Nicola&#39;s Comments (RSS 2.0)" href="../../../../members/chnicola/comments/rss.aspx"  />
<link rel="alternate" type="application/rss+xml" title="Chris Nicola&#39;s Activities (RSS 2.0)" href="../../../../members/chnicola/activities/rss.aspx"  />
<link rel="alternate" type="application/rss+xml" title="Chris Nicola&#39;s Friends Activity (RSS 2.0)" href="../../../../members/chnicola/activities/friendrss.aspx"  />

        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        <style type="text/css"> body { font-size: 84%; } </style>
        <link rel="stylesheet" href="../../../../themes/hawaii/style/Common.css" type="text/css" media="screen,print" />
        <link rel="stylesheet" href="../../../../themes/hawaii/style/common_print.css" type="text/css" media="print" />
        
    
    <link rel="stylesheet" href="../../../../Themes/hawaii/style/wiki.css" type="text/css" media="screen,print" />
	

        <link rel="stylesheet" href="../../../../themes/hawaii/style/DynamicStyle.aspx.css" type="text/css" media="screen" />
        <!--[if lte IE 6]>
            <link rel="stylesheet" href="/themes/hawaii/style/ie6.css" type="text/css" media="screen" />
        <![endif]-->
    <meta name="google-site-verification" content="u9qihpHbzSFdf2ypCUvCQrj9IJkANGzorC8zMk0859M" />
<title>
	Creating a custom id generator for nHibernate: Revision #5 - NHibernate Forge
</title></head>
	<body>
		<form name="aspnetForm" method="post" action="5.aspx.html" id="aspnetForm">
<div>
<input type="hidden" name="__VIEWSTATE" id="__VIEWSTATE" value="/wEPDwULLTE2ODYxODYyODBkGAEFHl9fQ29udHJvbHNSZXF1aXJlUG9zdEJhY2tLZXlfXxYBBTBjdGwwMCRjdGwwMCRzciRzciRjdGwwMCRjdGwwMCRUaXRsZUJhclNlYXJjaFRleHRS2dku67jB2SYXikwjMUBFR1YWDw==" />
</div>


<script src="../../../../WebResource.axd%3Fd=0gbcOAOlbWsHyCtP1tLKZQbpxrEkhg31E8L04T1x-hMLrsMonvmUNQvxBohSywWHueFgWT841lW9e5k7Gp2DbPsOLeN3Sv3SB7czfVSlQGxYOHnJcLlKfh3v9vlcjJ9ggvps0fjahw73J3SVYQmGvS0rXng1&amp;t=634395149500000000" type="text/javascript"></script>
<script src="../../../../WebResource.axd%3Fd=qXX_qxw7Y60qjc1NsxHnuIWUCy9JxjEUKLrY5KEQyuYhKzv3UmRPH805gTXU5edfSsLl7PHTIDuZbzGOp5UYEWeQ6anyqFa-m5TiNnZiD5MOrgiKWAZBgPyJ267gdCbk0_TpK2BaAhLvEgyM28dt9SYQ2UM1&amp;t=634395149500000000" type="text/javascript"></script>
<script src="../../../../WebResource.axd%3Fd=c5kkseX-7hUDg441H_iVoy5ws7YKvwS4KliHEKHuRl5UdJkUU5Jbdf2sxzCcbfyn6sqe17DzqhSTfAyV8nyJKMHhScl2IzjSz37RVYryN9Omis3K0NCj_OJ4fHZH3n9_IPBlNLVyYL45kjJL_zhydrkKTi3FfxaImDeS_1JZIO7o9iFs0&amp;t=634395149500000000" type="text/javascript"></script>
						

			

		    
		        <div id="CommonHeader">
		            <div class="Common">
		                <div id="CommonHeaderTitleArea">
		                    <table cellpadding="0" cellspacing="0" border="0"><tr valign="middle">
		                        <td><div style="margin-right: 10px;"><img src="../../../../cfs-file_ashx/__key/CommunityServer.Components.SiteFiles/logos/LogoNH.gif" alt="" style="border-width:0px;" /></div></td>
		                        <td>
		                            <div class="CommonHeaderTitle">NHibernate Forge</div>
		                            <div class="CommonHeaderTitleDescription">The official new home for the NHibernate for .NET community</div>
		                        </td>
		                    </tr></table>
		                </div>
		                <div id="CommonHeaderUserArea">
		                    <table cellpadding="0" cellspacing="0" border="0"><tr valign="top"><td>
                                <div id="CommonHeaderUserContent">
                                    <div id="CommonHeaderUserWelcome">
                                        
        <a href="../../../../login.aspx%3FReturnUrl=%252Fwikis%252Fhowtonh%252Fcreating-a-custom-id-generator-for-nhibernate%252Frevision%252F5.aspx.html">Sign in </a>
         | <a href="../../../../user/CreateUser.aspx%3FReturnUrl=.html">Join</a>
        | <a href="http://dev.communityserver.com/r.ashx?K&amp;siteurl=wikis.wiki_Page_ViewRevision">Help</a>
     


                                    </div>
                                </div>
                            </td></tr></table>
                        </div>
                    </div>
                </div>
                <div id="CommonNavigation">
                    <div class="Common"><div class="Inner">
                        <ul>
                                
                                <li><a href="../../../../index.html">Home</a></li>
                            
                                
                                <li><a href="../../../../blogs/nhibernate.html">Blog</a></li>
                            
                                <li><a class="Selected" href="../../../index.html">Wikis</a></li>
                                
                            
                                
                                <li><a href="../../../../groups/index.html">Groups</a></li>
                            
                                
                                <li><a href="../../../../doc/nh/en/index.html">Reference</a></li>
                            
                                
                                <li><a href="http://nhibernate.jira.com">Issue tracker</a></li>
                            
                                
                                <li><a href="https://github.com/nhibernate/nhibernate-core">Source Code</a></li>
                            </ul>
                        <div style="clear: both;"></div>
                     </div></div>
                </div>
                
                        <div id="CommonNavigation2">
                            <div class="Common"><div class="Inner">
                                <ul>
                    
                        
                        <li><a href="../../../general/default.aspx.html">General</a></li>
                    
                        <li><a class="Selected" href="../../default.aspx.html">How to</a></li>
                        
                    
                        
                        <li><a href="../../../patternsandpractices/default.aspx.html">Patterns&Practices</a></li>
                    
                                </ul>
                            </div></div>
                        </div>
                    
                <div id="CommonNavigationShadow">
                    
    
    <div class="CommonBreadCrumbArea"><div class="Common">
        <a href="../../../index.html">Wikis</a>
        &raquo;
        <a href="../../default.aspx.html">How to</a>
        &raquo;
        <a href="../../creating-a-custom-id-generator-for-nhibernate.aspx.html">Creating a custom id generator for nHibernate</a>
        &raquo;
        Revision #5
    </div></div>


                </div>
		    
                        
            <div class="Common">
            
                
            
                <div id="CommonSearch">
                    
    
        
                <div class="CommonSearchArea">
                    <div class="CommonSearchRoundTop"><div class="r1"></div><div class="r2"></div><div class="r3"></div><div class="r4"></div></div>
                    <div class="CommonSearchContent"><div class="CommonSearchContentInner">
                        <input name="ctl00$ctl00$sr$sr$ctl00$ctl00$TitleBarSearchText" type="text" maxlength="64" size="15" id="ctl00_ctl00_sr_sr_ctl00_ctl00_TitleBarSearchText" onclick="if(this.defaultValue==this.value) this.value='';" onblur="if(this.value=='') this.value=this.defaultValue;" onkeydown="return KeyDownHandlerctl00_ctl00_sr_sr_ctl00_ctl00_TitleBarSearchButton(event);" /><input type="submit" name="ctl00$ctl00$sr$sr$ctl00$ctl00$TitleBarSearchButton" value="Â " id="ctl00_ctl00_sr_sr_ctl00_ctl00_TitleBarSearchButton" class="CommonSearchButton" />
                    </div></div>
                    <div class="CommonSearchRoundBottom"><div class="r1"></div><div class="r2"></div><div class="r3"></div><div class="r4"></div></div>
                </div>
            
    

                </div>
                <div id="CommonTitle">
                    
    
    <h1 class="CommonTitle">Creating a custom id generator for nHibernate: 
            Revision #5
        </h1>


                </div>
                <div style="clear: both;"></div>
			    <div id="CommonSidebarRight">
			        
    
	<div class="CommonSidebar">
	    
	    
	        
	                <div class="CommonContentBox">
                        <h4 class="CommonContentBoxHeader">Shortcuts</h4>
	                    <div class="CommonContentBoxContent">
	            <ul class='CommonSidebarList'><li><a href="../../default.aspx.html">Home</a></li><li><a href="../rss.aspx">RSS feed for page</a></li></ul>
				        </div>
				        
			        </div>
	            
	    
	        
	    
	        
	                <div class="CommonContentBox">
                        <h4 class="CommonContentBoxHeader">Wiki Page Hierarchy</h4>
	                    <div class="CommonContentBoxContent">
	            <div><ul class="CommonHierarchicalList"><li><a href="../../mapping-a-view-and-schema-export-workaround.aspx.html">Mapping a view and Schema Export Workaround</a></li><li><a href="../../lazy-loading-eager-loading.aspx.html">Lazy loading - eager loading</a></li><li><a href="../../configure-log4net-for-use-with-nhibernate.aspx.html">Configure Log4Net for use with NHibernate</a></li><li><a href="../../get-unique-results-from-joined-queries.aspx.html">Get unique results from joined queries</a></li><li><a href="5.aspx.html#" onclick="ctl00_ctl00_rcr_rcr_ctl00_ctl02_ctl00_ctl01_ctl01._expand(30, this); return false;"><img src="../../../../WebResource.axd%3Fd=sNXLzaCqbYO_a-ZjCZB88HF4WT8YRbuRaD2xfyafsCiRqelSVt4GYH9QzNn_EvXM02V5zpjGwsymzmW30OIrbB4EUeqA1XW4oU6sME2qMEcOgSVpfz1_YK7UdKB8bVtbFiuWJt3UljrDk5OnRzQEWKDyXNGX0R6sJsultQeBjufuUDz-0&amp;t=634395149500000000" alt="+" style="border-width: 0;" /></a><a href="../../your-first-nhibernate-based-application.aspx.html">Your first NHibernate based application</a></li><li><a href="../../run-in-medium-trust.aspx.html">Run in Medium Trust</a></li><li><a href="../../pre-generate-lazy-loading-proxies.aspx.html">Pre-Generate Lazy Loading Proxies</a></li><li><a href="5.aspx.html#" onclick="ctl00_ctl00_rcr_rcr_ctl00_ctl02_ctl00_ctl01_ctl01._expand(42, this); return false;"><img src="../../../../WebResource.axd%3Fd=sNXLzaCqbYO_a-ZjCZB88HF4WT8YRbuRaD2xfyafsCiRqelSVt4GYH9QzNn_EvXM02V5zpjGwsymzmW30OIrbB4EUeqA1XW4oU6sME2qMEcOgSVpfz1_YK7UdKB8bVtbFiuWJt3UljrDk5OnRzQEWKDyXNGX0R6sJsultQeBjufuUDz-0&amp;t=634395149500000000" alt="+" style="border-width: 0;" /></a><a href="../../using-user-types.aspx.html">Using User Types</a></li><li><a href="../../lazy-loaded-one-to-one-with-nhibernate.aspx.html">Lazy Loaded One-To-One With NHibernate </a></li><li><a href="../../dynamically-change-user-info-in-connection-string.aspx.html">Dynamically change user info in connection string</a></li><li><a href="../../contextual-data-using-nhibernate-filters.aspx.html">Contextual data using NHibernate filters</a></li><li><a href="../../mapping-the-same-class-to-a-view-and-a-table-using-entity-name.aspx.html">Mapping the same class to a view and a table using entity-name</a></li><li><a href="../../creating-an-audit-log-using-nhibernate-events.aspx.html">Creating an Audit Log using NHibernate Events</a></li><li><a href="5.aspx.html#" onclick="ctl00_ctl00_rcr_rcr_ctl00_ctl02_ctl00_ctl01_ctl01._expand(51, this); return false;"><img src="../../../../WebResource.axd%3Fd=sNXLzaCqbYO_a-ZjCZB88HF4WT8YRbuRaD2xfyafsCiRqelSVt4GYH9QzNn_EvXM02V5zpjGwsymzmW30OIrbB4EUeqA1XW4oU6sME2qMEcOgSVpfz1_YK7UdKB8bVtbFiuWJt3UljrDk5OnRzQEWKDyXNGX0R6sJsultQeBjufuUDz-0&amp;t=634395149500000000" alt="+" style="border-width: 0;" /></a><a href="../../create-a-custom-message-interpolator-for-nhibernate-validator.aspx.html">Create a custom message interpolator for NHibernate Validator</a></li><li><a href="../../use-postgresql-arrays-with-nhibernate.aspx.html">Use PostgreSQL Arrays with NHibernate</a></li><li><a href="../../retrieve-a-nested-component-with-criteria-api.aspx.html">Retrieve a nested component with Criteria API</a></li><li><a href="../../tuning-queries-with-ms-sqlserver.aspx.html">Tuning queries with MS SQLServer</a></li><li><a href="../../nhibernate-concurrency-with-oracle-s-ora-rowscn.aspx.html">NHibernate concurrency with Oracle&#39;s ORA_ROWSCN</a></li><li><a href="../../the-best-way-to-get-nhibernate-community-support-submit-precise-description-of-the-problem.aspx.html">The best way to get NHibernate community support ? Submit precise description of the problem</a></li><li><a href="../../simple-audit-metadata-and-logical-deletion-of-business-entities.aspx.html">Simple audit metadata and logical deletion of business entities</a></li><li><a href="../../prefent-nhibernate-from-saving-default-relations.aspx.html">Prefent NHibernate from saving default relations</a></li><li><a href="../../creating-a-custom-id-generator-for-nhibernate.aspx.html" class="Selected">Creating a custom id generator for nHibernate</a></li><li><a href="5.aspx.html#" onclick="ctl00_ctl00_rcr_rcr_ctl00_ctl02_ctl00_ctl01_ctl01._expand(66, this); return false;"><img src="../../../../WebResource.axd%3Fd=sNXLzaCqbYO_a-ZjCZB88HF4WT8YRbuRaD2xfyafsCiRqelSVt4GYH9QzNn_EvXM02V5zpjGwsymzmW30OIrbB4EUeqA1XW4oU6sME2qMEcOgSVpfz1_YK7UdKB8bVtbFiuWJt3UljrDk5OnRzQEWKDyXNGX0R6sJsultQeBjufuUDz-0&amp;t=634395149500000000" alt="+" style="border-width: 0;" /></a><a href="../../finding-dirty-properties-in-nhibernate.aspx.html">Finding Dirty Properties in NHibernate</a></li><li><a href="../../currentsessioncontext-for-desktop-development.aspx.html">CurrentSessionContext for Desktop development</a></li><li><a href="../../customizing-fluent-nhibernate-s-autopersistencemodel-conventions.aspx.html">Customizing Fluent Nhibernate&#39;s AutoPersistenceModel Conventions</a></li><li><a href="../../how-to-use-db2hbm.aspx.html">How to use Db2hbm</a></li><li><a href="../../localization-techniques.aspx.html">Localization techniques</a></li><li><a href="../../calling-oracle-procedure-inside-package.aspx.html">Calling Oracle Procedure inside package</a></li><li><a href="../../how-to-get-help-with-nhibernate.aspx.html">How To Get Help with NHibernate</a></li><li><a href="../../nhibernate-features.aspx.html">NHibernate Features</a></li><li><a href="../../using-nlog-via-common-logging-with-nhibernate.aspx.html">Using NLog via Common.Logging with NHibernate</a></li><li><a href="../../keeping-entity-state-over-multiple-nhibernate-sessions.aspx.html">Keeping Entity State Over Multiple NHibernate Sessions</a></li><li><a href="../../enumerating-first-level-cache-entities.aspx.html">Enumerating First Level Cache Entities</a></li><li><a href="../../hilo-generator-with-node-suffix.aspx.html">HiLo Generator With Node Suffix</a></li><li><a href="../../nhibernate-audit-trails-and-onpreinsert-onpreupdate-event-listeners-vs-save-update-event-listeners.aspx.html">Changing Values in NHibernate Events</a></li><li><a href="../../conventionmodelmapper-amp-net-4-iset-lt-gt.aspx.html">ConventionModelMapper &amp; .net 4 ISet&lt;&gt;</a></li><li><a href="../../conventionmodelmapper-change-manytoone-column-name.aspx.html">ConventionModelMapper - change ManyToOne column name</a></li><li><a href="../../view-the-xml-generated-when-mapping-by-code.aspx.html">View the xml generated when mapping by code</a></li><li><a href="../../net-type-generation-for-nhibernate-mapping-collections.aspx.html">.NET type generation for NHibernate mapping collections</a></li><li><a href="../../a-fully-working-skeleton-for-sexy-loquacious-nh.aspx.html">A fully working skeleton for sexy Loquacious NH</a></li><li><a href="../../checking-if-an-unloaded-collection-contains-elements.aspx.html">Checking if an Unloaded Collection Contains Elements</a></li><li><a href="../../mapping-tables.aspx.html">Mapping tables</a></li><li><a href="../../wcf-nhibernate-entity-serialization.aspx.html">WCF + NHibernate: Entity Serialization</a></li></ul></div>
				        </div>
				        
			        </div>
	            
	    
	        
	                <div class="CommonContentBox">
                        <h4 class="CommonContentBoxHeader">Pages</h4>
	                    <div class="CommonContentBoxContent">
	            <div><ul class="CommonHierarchicalList"><li><a href="../../mapping-a-view-and-schema-export-workaround.aspx.html">Mapping a view and Schema Export Workaround</a></li><li><a href="../../lazy-loading-eager-loading.aspx.html">Lazy loading - eager loading</a></li><li><a href="../../configure-log4net-for-use-with-nhibernate.aspx.html">Configure Log4Net for use with NHibernate</a></li><li><a href="../../get-unique-results-from-joined-queries.aspx.html">Get unique results from joined queries</a></li><li><a href="5.aspx.html#" onclick="ctl00_ctl00_rcr_rcr_ctl00_ctl03_ctl00_ctl01_ctl01._expand(30, this); return false;"><img src="../../../../WebResource.axd%3Fd=sNXLzaCqbYO_a-ZjCZB88HF4WT8YRbuRaD2xfyafsCiRqelSVt4GYH9QzNn_EvXM02V5zpjGwsymzmW30OIrbB4EUeqA1XW4oU6sME2qMEcOgSVpfz1_YK7UdKB8bVtbFiuWJt3UljrDk5OnRzQEWKDyXNGX0R6sJsultQeBjufuUDz-0&amp;t=634395149500000000" alt="+" style="border-width: 0;" /></a><a href="../../your-first-nhibernate-based-application.aspx.html">Your first NHibernate based application</a></li><li><a href="../../run-in-medium-trust.aspx.html">Run in Medium Trust</a></li><li><a href="../../pre-generate-lazy-loading-proxies.aspx.html">Pre-Generate Lazy Loading Proxies</a></li><li><a href="5.aspx.html#" onclick="ctl00_ctl00_rcr_rcr_ctl00_ctl03_ctl00_ctl01_ctl01._expand(42, this); return false;"><img src="../../../../WebResource.axd%3Fd=sNXLzaCqbYO_a-ZjCZB88HF4WT8YRbuRaD2xfyafsCiRqelSVt4GYH9QzNn_EvXM02V5zpjGwsymzmW30OIrbB4EUeqA1XW4oU6sME2qMEcOgSVpfz1_YK7UdKB8bVtbFiuWJt3UljrDk5OnRzQEWKDyXNGX0R6sJsultQeBjufuUDz-0&amp;t=634395149500000000" alt="+" style="border-width: 0;" /></a><a href="../../using-user-types.aspx.html">Using User Types</a></li><li><a href="../../lazy-loaded-one-to-one-with-nhibernate.aspx.html">Lazy Loaded One-To-One With NHibernate </a></li><li><a href="../../dynamically-change-user-info-in-connection-string.aspx.html">Dynamically change user info in connection string</a></li><li><a href="../../contextual-data-using-nhibernate-filters.aspx.html">Contextual data using NHibernate filters</a></li><li><a href="../../mapping-the-same-class-to-a-view-and-a-table-using-entity-name.aspx.html">Mapping the same class to a view and a table using entity-name</a></li><li><a href="../../creating-an-audit-log-using-nhibernate-events.aspx.html">Creating an Audit Log using NHibernate Events</a></li><li><a href="5.aspx.html#" onclick="ctl00_ctl00_rcr_rcr_ctl00_ctl03_ctl00_ctl01_ctl01._expand(51, this); return false;"><img src="../../../../WebResource.axd%3Fd=sNXLzaCqbYO_a-ZjCZB88HF4WT8YRbuRaD2xfyafsCiRqelSVt4GYH9QzNn_EvXM02V5zpjGwsymzmW30OIrbB4EUeqA1XW4oU6sME2qMEcOgSVpfz1_YK7UdKB8bVtbFiuWJt3UljrDk5OnRzQEWKDyXNGX0R6sJsultQeBjufuUDz-0&amp;t=634395149500000000" alt="+" style="border-width: 0;" /></a><a href="../../create-a-custom-message-interpolator-for-nhibernate-validator.aspx.html">Create a custom message interpolator for NHibernate Validator</a></li><li><a href="../../use-postgresql-arrays-with-nhibernate.aspx.html">Use PostgreSQL Arrays with NHibernate</a></li><li><a href="../../retrieve-a-nested-component-with-criteria-api.aspx.html">Retrieve a nested component with Criteria API</a></li><li><a href="../../tuning-queries-with-ms-sqlserver.aspx.html">Tuning queries with MS SQLServer</a></li><li><a href="../../nhibernate-concurrency-with-oracle-s-ora-rowscn.aspx.html">NHibernate concurrency with Oracle&#39;s ORA_ROWSCN</a></li><li><a href="../../the-best-way-to-get-nhibernate-community-support-submit-precise-description-of-the-problem.aspx.html">The best way to get NHibernate community support ? Submit precise description of the problem</a></li><li><a href="../../simple-audit-metadata-and-logical-deletion-of-business-entities.aspx.html">Simple audit metadata and logical deletion of business entities</a></li><li><a href="../../prefent-nhibernate-from-saving-default-relations.aspx.html">Prefent NHibernate from saving default relations</a></li><li><a href="../../creating-a-custom-id-generator-for-nhibernate.aspx.html" class="Selected">Creating a custom id generator for nHibernate</a></li><li><a href="5.aspx.html#" onclick="ctl00_ctl00_rcr_rcr_ctl00_ctl03_ctl00_ctl01_ctl01._expand(66, this); return false;"><img src="../../../../WebResource.axd%3Fd=sNXLzaCqbYO_a-ZjCZB88HF4WT8YRbuRaD2xfyafsCiRqelSVt4GYH9QzNn_EvXM02V5zpjGwsymzmW30OIrbB4EUeqA1XW4oU6sME2qMEcOgSVpfz1_YK7UdKB8bVtbFiuWJt3UljrDk5OnRzQEWKDyXNGX0R6sJsultQeBjufuUDz-0&amp;t=634395149500000000" alt="+" style="border-width: 0;" /></a><a href="../../finding-dirty-properties-in-nhibernate.aspx.html">Finding Dirty Properties in NHibernate</a></li><li><a href="../../currentsessioncontext-for-desktop-development.aspx.html">CurrentSessionContext for Desktop development</a></li><li><a href="../../customizing-fluent-nhibernate-s-autopersistencemodel-conventions.aspx.html">Customizing Fluent Nhibernate&#39;s AutoPersistenceModel Conventions</a></li><li><a href="../../how-to-use-db2hbm.aspx.html">How to use Db2hbm</a></li><li><a href="../../localization-techniques.aspx.html">Localization techniques</a></li><li><a href="../../calling-oracle-procedure-inside-package.aspx.html">Calling Oracle Procedure inside package</a></li><li><a href="../../how-to-get-help-with-nhibernate.aspx.html">How To Get Help with NHibernate</a></li><li><a href="../../nhibernate-features.aspx.html">NHibernate Features</a></li><li><a href="../../using-nlog-via-common-logging-with-nhibernate.aspx.html">Using NLog via Common.Logging with NHibernate</a></li><li><a href="../../keeping-entity-state-over-multiple-nhibernate-sessions.aspx.html">Keeping Entity State Over Multiple NHibernate Sessions</a></li><li><a href="../../enumerating-first-level-cache-entities.aspx.html">Enumerating First Level Cache Entities</a></li><li><a href="../../hilo-generator-with-node-suffix.aspx.html">HiLo Generator With Node Suffix</a></li><li><a href="../../nhibernate-audit-trails-and-onpreinsert-onpreupdate-event-listeners-vs-save-update-event-listeners.aspx.html">Changing Values in NHibernate Events</a></li><li><a href="../../conventionmodelmapper-amp-net-4-iset-lt-gt.aspx.html">ConventionModelMapper &amp; .net 4 ISet&lt;&gt;</a></li><li><a href="../../conventionmodelmapper-change-manytoone-column-name.aspx.html">ConventionModelMapper - change ManyToOne column name</a></li><li><a href="../../view-the-xml-generated-when-mapping-by-code.aspx.html">View the xml generated when mapping by code</a></li><li><a href="../../net-type-generation-for-nhibernate-mapping-collections.aspx.html">.NET type generation for NHibernate mapping collections</a></li><li><a href="../../a-fully-working-skeleton-for-sexy-loquacious-nh.aspx.html">A fully working skeleton for sexy Loquacious NH</a></li><li><a href="../../checking-if-an-unloaded-collection-contains-elements.aspx.html">Checking if an Unloaded Collection Contains Elements</a></li><li><a href="../../mapping-tables.aspx.html">Mapping tables</a></li><li><a href="../../wcf-nhibernate-entity-serialization.aspx.html">WCF + NHibernate: Entity Serialization</a></li></ul></div>
				        </div>
				        
			        </div>
	            
	    
	        
	                <div class="CommonContentBox">
                        <h4 class="CommonContentBoxHeader">Tags</h4>
	                    <div class="CommonContentBoxContent">
	            <ul class="CommonSidebarTagCloud">
<li class="CommonTag6"><a href="../../tags/equality/default.aspx.html" rel="tag">equality</a></li>
<li class="CommonTag6"><a href="../../tags/identity/default.aspx.html" rel="tag">identity</a></li>
<li class="CommonTag1"><a href="../../tags/pattern/default.aspx.html" rel="tag">pattern</a></li>
<li class="CommonTag6"><a href="../../tags/unit+of+work/default.aspx.html" rel="tag">unit of work</a></li>
</ul>

				        </div>
				        <div class="CommonContentBoxFooter"><a href="../../tags/default.aspx.html">View more</a></div>
			        </div>
	            
	    
	        
	                <div class="CommonContentBox">
                        <h4 class="CommonContentBoxHeader">Page Details</h4>
	                    <div class="CommonContentBoxContent">
	            <div class="CustomWikiPageDetailsArea"><div class="CustomWikiPageDetailsTitle">First published by:</div><div class="CustomWikiPageDetailsAvatar"><img src="../../../../resized-image.ashx/__size/50x50/__key/CommunityServer.Components.Avatars/00.00.00.26.62/4TDB5C9OI7XU.png" alt="" style="border-width:0px;" /></div><div class="CustomWikiPageDetailsContent"><a href="../../../../members/chnicola/default.aspx.html">Chris Nicola</a><br/> on 09-03-2009</div></div><div class="CustomWikiPageDetailsArea"><div class="CustomWikiPageDetailsTitle">Last revision by:</div><div class="CustomWikiPageDetailsAvatar"><img src="../../../../resized-image.ashx/__size/50x50/__key/CommunityServer.Components.Avatars/00.00.00.21.24/4TCDVT33FMEU.jpg.html" alt="" style="border-width:0px;" /></div><div class="CustomWikiPageDetailsContent"><a href="../../../../members/sbohlen/default.aspx.html">Steve Bohlen</a><br/> on 11-20-2011</div></div><div class="WikiPageDetailsSummaryArea"><strong>1</strong> person found this article useful.</div>
				        </div>
				        
			        </div>
	            
	    
	    
	    
    </div>
    

			    </div>
                <div id="CommonSidebarLeft">
				    
				</div>
			    <div id="CommonContent"><div id="CommonContentInner">
    



<div class="CommonContentBox">
    <div class="CommonContentBoxContent">
        <div style="float: right">
            
        </div>
        
        <div class="CommonPaneTabSet">
            <div style="overflow: hidden; width: 100%;">
                <table border="0" cellpadding="0" cellspacing="0">
                <tbody>
                    <tr>
                        <td>
                            <div class="CommonPaneTab">
                                <a href="../../creating-a-custom-id-generator-for-nhibernate.aspx.html"><img align="absmiddle" border="0" src="../../../../Themes/hawaii/images/wiki/wiki-icon-article-tab.png" alt="" style="border-width:0px;" /></a>                            
                                <a href="../../creating-a-custom-id-generator-for-nhibernate.aspx.html">Article</a>
                            </div>
                        </td>
                        <td>
                            
                                    <div class="CommonPaneTab">
                                    
                                    
                                    </div>
                                
                        </td>
                        <td>
                            <div class="CommonPaneTab">
                                <a href="../comments.aspx.html"><img align="absmiddle" border="0" src="../../../../Themes/hawaii/images/wiki/wiki-icon-comment-tab.png" alt="" style="border-width:0px;" /></a>
                                <a href="../comments.aspx.html">Comments</a> (10)
                            </div>
                        </td>
                        <td>
                            <div class="CommonPaneTabSelected">
                                <a href="../history.aspx.html"><img align="absmiddle" border="0" src="../../../../Themes/hawaii/images/wiki/wiki-icon-history-tab.png" alt="" style="border-width:0px;" /></a>
                                <a href="../history.aspx.html">History</a> (11)
                            </div>
                        </td>
                    </tr>
                </tbody>
                </table>
            </div>
        </div>

        <div class="CommonPane">
            <div class="CommonGroupedContentArea">
                <h2 class="CommonContentBoxHeaderSmall"><span><a href="../../creating-a-custom-id-generator-for-nhibernate.aspx.html">Creating a custom id generator for nHibernate</a></span></h2>
                <div><p>I originally blogged about this <a href="http://www.lucisferre.net/post/2009/07/13/Implementing-a-custom-ID-generator-for-nHibernate.aspx">here </a>and <a href="http://www.lucisferre.net/post/2009/08/15/Generate-Custom-DDL-for-your-Custom-Id-Generator-with-nHibernate.aspx">here </a>on my <a href="http://coding.lucisferre.org"></a><a href="http://www.lucisferre.net">blog</a> but Fabio suggested I add these posts to the Forge, so here I am.&nbsp; I have to say I am a little exited to make my first contribution to the Wiki&nbsp;[H].&nbsp; I will try to add a bit more to them and show some examples that do not use the <code>TableGenerator </code>class but directly implement <code>IIdentifierGenerator </code>.  Please let me know if there are any mistakes or anything else you want to see.</p>
<p>Before beginning I recommend that you download the NH source code and take a quick look at the <code>TableGenerator </code>, <code>IIdentifierGenerator and </code><code>IPersistentIdentifierGenerator</code> classes as you will be working with these classes and interfaces to implement your custom generator.</p>
<h2>Part 1: Inheriting from TableGenerator class<br /></h2>
<p>Currently I am doing some work developing a utility that imports
securities data into a fairly old legacy database. It is still SQL but
the database and software havn&#39;t been updated in about 15 years (maybe
more) and never will be again.</p>
<p>The original application for this database uses a primitive
hilo-style ID generator mechanism. Tt simply queries an integer value
from a table in the database and increments it, then it adds a fixed
value to it and uses that as the next unique ID. It doesn&#39;t seem very
optimal, but that&#39;s how it works and there&#39;s no changing it.</p>
<p>It isn&#39;t complex, but it also isn&#39;t one of the identity strategies available in nHibernate and I fully intend to use nHibernate.</p>
<p>So what to do?  One option would be to set <code>generator=&quot;assigned&quot;</code> and do it all myself, assigning the ID using <code>ADO.Net </code>directly
or something similar... but what fun would that be? No, I&#39;ve decided to
take a peak at the nHibernate code and learn to extend it. Read on to
find out how to create a custom class that inherits from <code>IIdentifierGenerator </code>to implement your own custom ID generator strategy for nHibernate.</p>
<p>One of the beautiful things about nHibernate the ability to extend
it. You can extend its functionality without ever touching their source
code.</p>
<p>It was very easy to locate the classes responsible for ID generation in the <code>NHibernate.ID </code>namespace.  It was also clear immediately that most classes inherited from <code>IIdentifierGenerator</code>.&nbsp;  I also knew that my strategy was similar to the procedure that hilo implements so I started with <code>TableHiLoGenerator </code>which inherts from <code>TableGenerator</code>.</p>
<p>After playing around with this for a while and trying different things, it was clear that <code>TableGenerator</code>, basically takes a <code>tablename </code>and <code>columnname </code>from
the configuration, reads a value, increments it and passes it on as an
ID. Voila! That was almost exactly what I needed to do with little else
to change. I was quickly able to create my own class inheriting from
TableGenerator</p>
<div style="margin:5px;padding:5px;background:white none repeat scroll 0% 0%;font-family:Courier New;font-size:8pt;color:black;">
<p style="margin:0px;padding:0px;"><span style="color:blue;">public</span> <span style="color:blue;">class</span> <span style="color:#2b91af;">FDPSequence</span> : <span style="color:#2b91af;">TableGenerator</span></p>
<p style="margin:0px;padding:0px;">{</p>
<p style="margin:0px;padding:0px;">&nbsp;&nbsp;&nbsp; <span style="color:blue;">private</span> <span style="color:blue;">const</span> <span style="color:#2b91af;">Int32</span> SeedValue = 1048576;</p>
<p style="margin:0px;padding:0px;">&nbsp;</p>
<p style="margin:0px;padding:0px;">&nbsp;&nbsp;&nbsp; <span style="color:blue;">private</span> <span style="color:blue;">static</span> <span style="color:blue;">readonly</span> <span style="color:#2b91af;">ILog</span> Log = <span style="color:#2b91af;">LogManager</span>.GetLogger(<span style="color:blue;">typeof</span>(<span style="color:#2b91af;">FDPSequence</span>));</p>
<p style="margin:0px;padding:0px;">&nbsp;</p>
<p style="margin:0px;padding:0px;">&nbsp;&nbsp;&nbsp; <span style="color:blue;">public</span> <span style="color:blue;">override</span> <span style="color:blue;">object</span> Generate(<span style="color:#2b91af;">ISessionImplementor</span> session, <span style="color:blue;">object</span> obj)</p>
<p style="margin:0px;padding:0px;">&nbsp;&nbsp;&nbsp; {</p>
<p style="margin:0px;padding:0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color:blue;">int</span> counter = <span style="color:#2b91af;">Convert</span>.ToInt32(<span style="color:blue;">base</span>.Generate(session, obj));</p>
<p style="margin:0px;padding:0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <span style="color:blue;">return</span> counter + SeedValue + 1;</p>
<p style="margin:0px;padding:0px;">&nbsp;&nbsp;&nbsp; }</p>
<p style="margin:0px;padding:0px;">}</p>
</div>
<p>Not much to that is there? Now that is a fairly simple case, but
even getting more complex isn&#39;t much harder than that. You can
implement <code>IIdentifierGenerator </code>directly and create
something far more customized. TableGenerator actually implements
<code>IPersistentIdentifierGenerator</code> which is an interface for identifiers
which need to write and updated value to the database. However, since
nHibernate provides so many versatile and inheritable base class
generators that you will likely get by with inheriting one of those and
extending it as I did.</p>
<p>In order to use this custom generator class I setup my configuration to use it.  Using Fluent I wrote a mapping like this:</p>
<div style="margin:5px;padding:5px;background:white none repeat scroll 0% 0%;font-family:Courier New;font-size:8pt;color:black;">
<p style="margin:0px;padding:0px;"><span style="color:blue;">public</span> <span style="color:blue;">class</span> <span style="color:#2b91af;">InvestSpecMap</span> : <span style="color:#2b91af;">FDPEntityBaseMap</span>&lt;<span style="color:#2b91af;">InvestSpec</span>&gt;</p>
<p style="margin:0px;padding:0px;">{</p>
<p style="margin:0px;padding:0px;">&nbsp;&nbsp;&nbsp; <span style="color:blue;">public</span> InvestSpecMap()</p>
<p style="margin:0px;padding:0px;">&nbsp;&nbsp;&nbsp; {</p>
<p style="margin:0px;padding:0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; WithTable(<span style="color:#a31515;">&quot;InvestSpec&quot;</span>);</p>
<p style="margin:0px;padding:0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; Id(x =&gt; x.Id).ColumnName(tablename + <span style="color:#a31515;">&quot;ID&quot;</span>)</p>
<p style="margin:0px;padding:0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; .SetGeneratorClass(<span style="color:blue;">typeof</span>(FDPGenerator.<span style="color:#2b91af;">FDPSequence</span>).AssemblyQualifiedName)</p>
<p style="margin:0px;padding:0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; .AddGeneratorParam(<span style="color:#a31515;">&quot;table&quot;</span>, <span style="color:#a31515;">&quot;zSysCounters&quot;</span>) <span style="color:green;">//Name of the ID counter table</span></p>
<p style="margin:0px;padding:0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; .AddGeneratorParam(<span style="color:#a31515;">&quot;column&quot;</span>, <span style="color:#a31515;">&quot;InvestSpec&quot;</span>); <span style="color:green;">//ID counter column for this table</span></p>
<p style="margin:0px;padding:0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; Map(x =&gt; x.AnnualDividend).ColumnName(<span style="color:#a31515;">&quot;AnnlzdDiv&quot;</span>);</p>
<p style="margin:0px;padding:0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; Map(x =&gt; x.AssetClass);</p>
<p style="margin:0px;padding:0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; Map(x =&gt; x.CurrencyType);</p>
<p style="margin:0px;padding:0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; Map(x =&gt; x.CusipNumber).ColumnName(<span style="color:#a31515;">&quot;CusipNum&quot;</span>);</p>
<p style="margin:0px;padding:0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; Map(x =&gt; x.DividendFreq).ColumnName(<span style="color:#a31515;">&quot;DivFrequency&quot;</span>);</p>
<p style="margin:0px;padding:0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; Map(x =&gt; x.FullName);</p>
<p style="margin:0px;padding:0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; Map(x =&gt; x.MaturityDate).ColumnName(<span style="color:#a31515;">&quot;MaturityDt&quot;</span>);</p>
<p style="margin:0px;padding:0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; Map(x =&gt; x.PriceAsOf).ColumnName(<span style="color:#a31515;">&quot;PriceAsOfDt&quot;</span>);</p>
<p style="margin:0px;padding:0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; Map(x =&gt; x.ShortName).ColumnName(<span style="color:#a31515;">&quot;AbbrName&quot;</span>);</p>
<p style="margin:0px;padding:0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; Map(x =&gt; x.TaxTreatment);</p>
<p style="margin:0px;padding:0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; Map(x =&gt; x.TickerSymbol);</p>
<p style="margin:0px;padding:0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; Map(x =&gt; x.Type);</p>
<p style="margin:0px;padding:0px;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; Map(x =&gt; x.UnitPrice);</p>
<p style="margin:0px;padding:0px;">&nbsp;&nbsp;&nbsp; }</p>
<p style="margin:0px;padding:0px;">}</p>
</div>
<p>You can do the same with XML mappings just declare the assembly and
class as you usually would in XML. This is actually the first time I&#39;ve
used FluentNH.</p>
<p>What is great about this is that even when testing my mappings with SQLLite, <code>SchemaExport </code>is
actually able to create the identity table based on the tablename and
columnname properties in the nHibernate configuration. The main benefit
here however is that identity generation remains transparent to the
rest of my application. Also doing something cool with nHibernate,
that&#39;s priceless of course</p>
<h2>Part 2: Stealing from TableGenerator and controlling DDL generation</h2>
<p>A while ago I <a href="http://www.lucisferre.org/coding/index.php/2009/07/13/implementing-a-custom-id-generator-for-nhibernate-1">posted </a>
about writing a custom id generator using nHibernate and extending one
of the existing Generator classes nHibernate provides.&nbsp; This was done
to support working with a legacy database which uses a custom id
generation strategy.&nbsp; One thing I like to do with all my apps is write
some basic CRUD tests to make sure my mappings and queries are all
working properly.</p>
<p>To do this I use Oren&#39;s approach of <a href="http://ayende.com/Blog/archive/2009/04/28/nhibernate-unit-testing.aspx">creating a temporary in-memory database </a>using SQLite to work with.&nbsp; This involves using the&nbsp; <code>SchemaExport </code>tool
in nHibernate to generate the DDL to create the database.&nbsp; If you are
using a table generator strategy it also needs to create the table and
columns for the custom id generator.&nbsp; In some cases you may need to
customize the DDL for your Id table.</p>
<p>As I discovered the DDL to generate the table to store the next id value for my custom id is
only created once and does not check the column name value for each class.&nbsp; For my id generator there is a separate column used for
each table in the database, so this was a problem.&nbsp; For example, the <i>Price </i>table has a column in the <i>Counter </i>table called <i>Price </i>to store it&#39;s counter and the <i>Holding </i>table has a column called <i>Holding</i>, but I was only getting one column (this appears to be a <a href="http://stackoverflow.com/questions/1944927/schemaexport-vs-hilo-algorithm">problem with hilo and SchemaExport</a>, you can currently only have one column per database)</p>
<p>The TableGenerator class supports two parameters which are set in the HBM files (or using fluent) <i>tablename </i>and <i>columnname </i>which
set the table and column names used for the id counter.&nbsp; If you have a
copy of the nHibernate source code you will see that the TableGenerator
class calls<code> SqlCreateStrings()</code>and <code>SqlDropString()</code>
to create and drop the table for the id generator.&nbsp; Unfortunately, as I
mentioned above this is only called once, and so it only creates one
table with one column for whichever mapping is handled first.</p>
<p>In order to fix this I had to copy the <code>TableGenerator </code>class (yes, yes, I know copy-paste is bad form) and modify those functions.&nbsp; I also added a third parameter <i>allcolumnnames</i> in which I can provide a comma separated list of all the columns the table needs to have (one per table in my database).&nbsp; The <code>SqlCreateStrings()</code>is simple changed to:</p>
<div style="margin:16px;padding:8px;background:white none repeat scroll 0% 0%;font-family:Courier New;font-size:8pt;color:black;-moz-background-clip:border;-moz-background-origin:padding;-moz-background-inline-policy:continuous;">
<p style="margin:0px;padding:0px;"><span style="color:blue;">public</span> <span style="color:blue;">string</span>[] SqlCreateStrings(<span style="color:#2b91af;">Dialect</span> dialect) {</p>
<p style="margin:0px;padding:0px;">&nbsp; <span style="color:blue;">string</span> create = <span style="color:#a31515;">&quot;create table &quot;</span> + tableName + <span style="color:#a31515;">&quot; (&quot;</span>;</p>
<p style="margin:0px;padding:0px;">&nbsp; <span style="color:blue;">string</span> insert = <span style="color:#a31515;">&quot;insert into &quot;</span> + tableName + <span style="color:#a31515;">&quot; values (&quot;</span>;</p>
<p style="margin:0px;padding:0px;">&nbsp; <span style="color:blue;">foreach</span> (<span style="color:blue;">string</span> s <span style="color:blue;">in</span> allcolumns.Split(<span style="color:#a31515;">&#39;,&#39;</span>)) {</p>
<p style="margin:0px;padding:0px;">&nbsp; &nbsp; create += <span style="color:#a31515;">&quot; &quot;</span> + s + <span style="color:#a31515;">&quot; &quot;</span> + dialect.GetTypeName(columnSqlType) + <span style="color:#a31515;">&quot;,&quot;</span>;</p>
<p style="margin:0px;padding:0px;">&nbsp; &nbsp; insert += <span style="color:#a31515;">&quot; 1,&quot;</span>;</p>
<p style="margin:0px;padding:0px;">&nbsp; }</p>
<p style="margin:0px;padding:0px;">&nbsp; create = create.Trim(<span style="color:#a31515;">&#39;,&#39;</span>) + <span style="color:#a31515;">&quot; )&quot;</span>;</p>
<p style="margin:0px;padding:0px;">&nbsp; insert = insert.Trim(<span style="color:#a31515;">&#39;,&#39;</span>) + <span style="color:#a31515;">&quot; )&quot;</span>;</p>
<p style="margin:0px;padding:0px;">&nbsp; <span style="color:blue;">return</span> <span style="color:blue;">new</span>[] {create, insert};</p>
<p style="margin:0px;padding:0px;">}</p>
</div>
<p>(Yes, yes, I know I should have learned from my <a href="http://www.lucisferre.org/coding/index.php/2009/08/04/strings-are-immutable-stupid">last post </a>and used a <code>StringBuilder </code>here as I pointed out in my last post, but seriously, this method will only ever be called once)</p>
<p>Now when it is called it will create the correct table with all the
columns I need. A couple of example mappings for the database in
FluentNH are shown below:</p>
<div style="margin:16px;padding:8px;background:white none repeat scroll 0% 0%;font-family:Courier New;font-size:8pt;color:black;-moz-background-clip:border;-moz-background-origin:padding;-moz-background-inline-policy:continuous;">
<p style="margin:0px;padding:0px;"><span style="color:blue;">public</span> InvestSpecMap() {</p>
<p style="margin:0px;padding:0px;">&nbsp; WithTable(<span style="color:#a31515;">&quot;InvestSpec&quot;</span>);</p>
<p style="margin:0px;padding:0px;">&nbsp; Id(x =&gt; x.Id).ColumnName(<span style="color:#a31515;">&quot;InvestSpecID&quot;</span>)</p>
<p style="margin:0px;padding:0px;">&nbsp; &nbsp; .SetGeneratorClass(<span style="color:blue;">typeof</span> (<span style="color:#2b91af;">FdpSequenceGen</span>).AssemblyQualifiedName)</p>
<p style="margin:0px;padding:0px;">&nbsp; &nbsp; .AddGeneratorParam(<span style="color:#a31515;">&quot;allcolumns&quot;</span>, <span style="color:#a31515;">&quot;InvestSpec, InvestPrice&quot;</span>)</p>
<p style="margin:0px;padding:0px;">&nbsp; &nbsp; .AddGeneratorParam(<span style="color:#a31515;">&quot;table&quot;</span>, <span style="color:#a31515;">&quot;zSysCounters&quot;</span>) <span style="color:green;">//ID counter table name</span></p>
<p style="margin:0px;padding:0px;">&nbsp; &nbsp; .AddGeneratorParam(<span style="color:#a31515;">&quot;column&quot;</span>, <span style="color:#a31515;">&quot;InvestSpec&quot;</span>); <span style="color:green;">//ID counter column name</span></p>
</div>
<div style="margin:16px;padding:8px;background:white none repeat scroll 0% 0%;font-family:Courier New;font-size:8pt;color:black;-moz-background-clip:border;-moz-background-origin:padding;-moz-background-inline-policy:continuous;">
<p style="margin:0px;padding:0px;"><span style="color:blue;">public</span> PriceMap() {</p>
<p style="margin:0px;padding:0px;">&nbsp; WithTable(<span style="color:#a31515;">&quot;InvestPrice&quot;</span>);</p>
<p style="margin:0px;padding:0px;">&nbsp; Id(x =&gt; x.Id).ColumnName(<span style="color:#a31515;">&quot;InvestPriceID&quot;</span>)</p>
<p style="margin:0px;padding:0px;">&nbsp; &nbsp; .SetGeneratorClass(<span style="color:blue;">typeof</span> (<span style="color:#2b91af;">FdpSequenceGen</span>).AssemblyQualifiedName)</p>
<p style="margin:0px;padding:0px;">&nbsp; &nbsp; .AddGeneratorParam(<span style="color:#a31515;">&quot;allcolumns&quot;</span>, <span style="color:#a31515;">&quot;InvestSpec, InvestPrice&quot;</span>)</p>
<p style="margin:0px;padding:0px;">&nbsp; &nbsp; .AddGeneratorParam(<span style="color:#a31515;">&quot;table&quot;</span>, <span style="color:#a31515;">&quot;zSysCounters&quot;</span>) <span style="color:green;">//ID counter table name</span></p>
<p style="margin:0px;padding:0px;">&nbsp; &nbsp; .AddGeneratorParam(<span style="color:#a31515;">&quot;column&quot;</span>, <span style="color:#a31515;">&quot;InvestPrice&quot;</span>); <span style="color:green;">//ID counter column name</span></p>
</div>
<p>To be completely &quot;clean code&quot; and avoid repeating myself I should probably factor out the <code>Id() </code>code into a method in an inhereted base class so I can call it from each mapping class like this:</p>
<div style="margin:16px;padding:8px;background:white none repeat scroll 0% 0%;font-family:Courier New;font-size:8pt;color:black;-moz-background-clip:border;-moz-background-origin:padding;-moz-background-inline-policy:continuous;">
<p style="margin:0px;padding:0px;"><span style="color:blue;">protected</span> <span style="color:blue;">void</span> SetIdGenerator(<span style="color:blue;">string</span> tablename) {</p>
<p style="margin:0px;padding:0px;">&nbsp; Id(x =&gt; x.Id).ColumnName(TableName + <span style="color:#a31515;">&quot;Id&quot;</span>)</p>
<p style="margin:0px;padding:0px;">&nbsp; &nbsp; .SetGeneratorClass(<span style="color:blue;">typeof</span>(<span style="color:#2b91af;">FdpSequenceGen</span>).AssemblyQualifiedName)</p>
<p style="margin:0px;padding:0px;">&nbsp; &nbsp; .AddGeneratorParam(<span style="color:#a31515;">&quot;allcolumns&quot;</span>, AllColumns)</p>
<p style="margin:0px;padding:0px;">&nbsp; &nbsp; .AddGeneratorParam(<span style="color:#a31515;">&quot;table&quot;</span>, <span style="color:#a31515;">&quot;zSysCounters&quot;</span>) <span style="color:green;">//ID counter table name</span></p>
<p style="margin:0px;padding:0px;">&nbsp; &nbsp; .AddGeneratorParam(<span style="color:#a31515;">&quot;column&quot;</span>, TableName); <span style="color:green;">//ID counter column name</span></p>
<p style="margin:0px;padding:0px;">}</p>
</div>
<p>Now I can unit test using a temporary in-memory SQLite database and all my tests are passing.</p></div>
            </div>
        </div>

    </div>
</div>


</div></div>
			    <div style="clear: both;"></div>
			    
			    
            </div>
                
            <div id="CommonFooter">
                <div class="Common">
                    
                        
                	    
                        

                        
                                <a href="http://communityserver.com/" target="_blank"><img src="../../../../utility/PoweredByCS_commercial.gif" alt="Powered by Community Server (Commercial Edition), by Telligent Systems " style="border-width:0px;" /></a>
		                    
                		
                    
                 </div>
            </div>
		
<script type="text/javascript">
// <![CDATA[
Telligent_Modal.Configure('/utility/loading.htm',['CommonModal'],['CommonModalTitle'],['CommonModalClose'],['CommonModalContent'],['CommonModalFooter'],['CommonModalResize'],['CommonModalMask'],100,false,true);
// ]]>
</script><script type="text/javascript">
<!--
function KeyDownHandlerctl00_ctl00_sr_sr_ctl00_ctl00_TitleBarSearchButton(event)
{
	if (event.keyCode == 13)
	{
		event.returnValue = false;
		event.cancel = true;
     __doPostBack('ctl00$ctl00$sr$sr$ctl00$ctl00$TitleBarSearchButton','')
   return false;
	}
}

//-->
</script>
<script type="text/javascript">
// <![CDATA[
window.ctl00_ctl00_rcr_rcr_ctl00_ctl02_ctl00_ctl01_ctl01=new WikiPageHierarchy('ctl00_ctl00_rcr_rcr_ctl00_ctl02_ctl00_ctl01_ctl01',new Function('mode','pageId','callback','WebForm_DoCallback(\'ctl00$ctl00$rcr$rcr$ctl00$ctl02$ctl00$ctl01$ctl01\',mode + \':\' + pageId,callback,\"\",null,false)'),'<img src="http://nhforge.org/wikis/howtonh/creating-a-custom-id-generator-for-nhibernate/revision/\&quot;/WebResource.axd?d=sNXLzaCqbYO_a-ZjCZB88HF4WT8YRbuRaD2xfyafsCiRqelSVt4GYH9QzNn_EvXM02V5zpjGwsymzmW30OIrbB4EUeqA1XW4oU6sME2qMEcOgSVpfz1_YK7UdKB8bVtbFiuWJt3UljrDk5OnRzQEWKDyXNGX0R6sJsultQeBjufuUDz-0&amp;t=634395149500000000\&quot;" alt=\"+\" style=\"border-width: 0;\" />','<img src="http://nhforge.org/wikis/howtonh/creating-a-custom-id-generator-for-nhibernate/revision/\&quot;/WebResource.axd?d=I7Z2L5Ca7ffItUeObf-LA3ykZ3Mbmr-vwfNJv2PfNk2O4alHWIJbJADyKhl0k71mJCpGTePjifKqZQx_Rs64LrGhlEU25qRjlCh8LoYwo2tck8EIbBdQKg5CISopk9hz_6ZbK_GNtBJljwOq57_FBvxYCTM1&amp;t=634395149500000000\&quot;" alt=\"-\" style=\"border-width: 0;\" />','<div>Loading...</div>');
// ]]>
</script><script type="text/javascript">
// <![CDATA[
window.ctl00_ctl00_rcr_rcr_ctl00_ctl03_ctl00_ctl01_ctl01=new WikiPageHierarchy('ctl00_ctl00_rcr_rcr_ctl00_ctl03_ctl00_ctl01_ctl01',new Function('mode','pageId','callback','WebForm_DoCallback(\'ctl00$ctl00$rcr$rcr$ctl00$ctl03$ctl00$ctl01$ctl01\',mode + \':\' + pageId,callback,\"\",null,false)'),'<img src="http://nhforge.org/wikis/howtonh/creating-a-custom-id-generator-for-nhibernate/revision/\&quot;/WebResource.axd?d=sNXLzaCqbYO_a-ZjCZB88HF4WT8YRbuRaD2xfyafsCiRqelSVt4GYH9QzNn_EvXM02V5zpjGwsymzmW30OIrbB4EUeqA1XW4oU6sME2qMEcOgSVpfz1_YK7UdKB8bVtbFiuWJt3UljrDk5OnRzQEWKDyXNGX0R6sJsultQeBjufuUDz-0&amp;t=634395149500000000\&quot;" alt=\"+\" style=\"border-width: 0;\" />','<img src="http://nhforge.org/wikis/howtonh/creating-a-custom-id-generator-for-nhibernate/revision/\&quot;/WebResource.axd?d=I7Z2L5Ca7ffItUeObf-LA3ykZ3Mbmr-vwfNJv2PfNk2O4alHWIJbJADyKhl0k71mJCpGTePjifKqZQx_Rs64LrGhlEU25qRjlCh8LoYwo2tck8EIbBdQKg5CISopk9hz_6ZbK_GNtBJljwOq57_FBvxYCTM1&amp;t=634395149500000000\&quot;" alt=\"-\" style=\"border-width: 0;\" />','<div>Loading...</div>');
// ]]>
</script><script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
var pageTracker = _gat._getTracker("UA-5443308-1");
pageTracker._trackPageview();
</script></form>
		
	</body>
</html>
